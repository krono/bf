(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     27614,        765]
NotebookOptionsPosition[     25531,        694]
NotebookOutlinePosition[     25889,        710]
CellTagsIndexPosition[     25846,        707]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
This material is distributed under the GNU General Public License Version 2.
You may review the terms of this license at \
http://www.gnu.org/licenses/gpl-2.0.html

Copyright (C) 2014, Michael Haupt <bf at haupz dot de>

All rights reserved.\
\>", "Text",
 CellChangeTimes->{{3.601827038156595*^9, 3.6018271561924763`*^9}}],

Cell["Helpers.", "Text",
 CellChangeTimes->{{3.582220219476334*^9, 3.5822202203929768`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"incr", "[", 
    RowBox[{"memory_", ",", "p_"}], "]"}], ":=", 
   RowBox[{"ReplacePart", "[", 
    RowBox[{"memory", ",", 
     RowBox[{"p", "\[Rule]", 
      RowBox[{
       RowBox[{"memory", "[", 
        RowBox[{"[", "p", "]"}], "]"}], "+", "1"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"decr", "[", 
    RowBox[{"memory_", ",", "p_"}], "]"}], ":=", 
   RowBox[{"ReplacePart", "[", 
    RowBox[{"memory", ",", 
     RowBox[{"p", "\[Rule]", 
      RowBox[{
       RowBox[{"memory", "[", 
        RowBox[{"[", "p", "]"}], "]"}], "-", "1"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"setm", "[", 
    RowBox[{"memory_", ",", "p_", ",", "c_"}], "]"}], ":=", 
   RowBox[{"ReplacePart", "[", 
    RowBox[{"memory", ",", 
     RowBox[{"p", "\[Rule]", "c"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"drop", "[", "s_", "]"}], ":=", 
   RowBox[{"StringDrop", "[", 
    RowBox[{"s", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"putc", "[", 
    RowBox[{"out_", ",", "c_"}], "]"}], ":=", 
   RowBox[{"out", "<>", 
    RowBox[{"FromCharacterCode", "[", "c", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getc", "[", "in_", "]"}], ":=", 
  RowBox[{
   RowBox[{"ToCharacterCode", "[", 
    RowBox[{
     RowBox[{"Characters", "[", "in", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.582220223961779*^9, 3.582220253995111*^9}, {
  3.582362854209401*^9, 3.582362875069841*^9}, {3.582926896355523*^9, 
  3.582926904130616*^9}, {3.582926944153735*^9, 3.582926967701474*^9}, {
  3.582927743798336*^9, 3.5829277889915733`*^9}, {3.5829278419913683`*^9, 
  3.58292790558425*^9}, {3.582927950956458*^9, 3.582927952345665*^9}}],

Cell[TextData[{
 "Syntax definition happens by currying a ",
 StyleBox["StringMatchQ", "Code"],
 " (i.e., binding the bf operator and leaving the string to match unbound)."
}], "Text",
 CellChangeTimes->{{3.5823612573563137`*^9, 3.5823612599219913`*^9}, {
  3.582362691080839*^9, 3.582362691334887*^9}, {3.582718149360773*^9, 
  3.5827182037534037`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DefBfSyntax", "[", "op_", "]"}], ":=", 
  RowBox[{"Function", "[", 
   RowBox[{"StringMatchQ", "[", 
    RowBox[{"##", ",", 
     RowBox[{"op", "~~", "rest___"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.582361265678199*^9, 3.5823613653139668`*^9}, {
   3.582361934830862*^9, 3.5823619351401052`*^9}, {3.582362143624034*^9, 
   3.582362165207279*^9}, {3.582362242446206*^9, 3.5823622534018784`*^9}, 
   3.582362326027926*^9, {3.582362580876586*^9, 3.582362583817112*^9}, {
   3.5823626326359167`*^9, 3.582362643585367*^9}, {3.582717863591279*^9, 
   3.582717877067545*^9}, {3.582717967050507*^9, 3.58271798975592*^9}, {
   3.5827180619538107`*^9, 3.582718080395047*^9}}],

Cell["Syntax recognisers.", "Text",
 CellChangeTimes->{{3.58271815135098*^9, 3.58271816527379*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BfPlus", ":=", 
   RowBox[{"DefBfSyntax", "[", "\"\<+\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BfMinus", ":=", 
   RowBox[{"DefBfSyntax", "[", "\"\<-\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BfLeft", ":=", 
   RowBox[{"DefBfSyntax", "[", "\"\<<\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BfRight", ":=", 
   RowBox[{"DefBfSyntax", "[", "\"\<>\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BfPrint", ":=", 
   RowBox[{"DefBfSyntax", "[", "\"\<.\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BfRead", ":=", 
   RowBox[{"DefBfSyntax", "[", "\"\<,\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BfWhile", ":=", 
   RowBox[{"DefBfSyntax", "[", "\"\<[\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"BfWend", ":=", 
  RowBox[{"DefBfSyntax", "[", "\"\<]\>\"", "]"}]}]}], "Input",
 CellChangeTimes->{{3.582290051476577*^9, 3.58229007300518*^9}, {
  3.582290115503325*^9, 3.5822901311168623`*^9}, {3.5823613797649193`*^9, 
  3.582361385984148*^9}, {3.582362653098186*^9, 3.582362653289081*^9}, {
  3.582362694303323*^9, 3.5823627593507833`*^9}, {3.582717930320168*^9, 
  3.582717946823636*^9}, {3.582717996787333*^9, 3.582718004419833*^9}, {
  3.5829266458120832`*^9, 3.5829266750671864`*^9}, {3.582928041045817*^9, 
  3.582928063306343*^9}}],

Cell[TextData[{
 "bf parameters are as follows:\n",
 StyleBox["memory: the bf memory.\[LineSeparator]p: the memory pointer.\
\[LineSeparator]code: the code to be run by the interpreter.\ncont: a list of \
strings; the continuations currently on the stack (see below about loop \
handling).\ninput: a character string that the interpreter reads from.\n\
output: a character string that the interpreter writes to.", "Item"]
}], "Text",
 CellChangeTimes->{{3.582219531463201*^9, 3.582219570632687*^9}, {
  3.5822196219219933`*^9, 3.582219630074873*^9}, {3.582926579884879*^9, 
  3.582926604628566*^9}, {3.582928889242886*^9, 3.582928929957796*^9}}],

Cell["\<\
The following definitions describe how the basic bf operators work.\
\>", "Text",
 CellChangeTimes->{{3.582927515383318*^9, 3.582927524546113*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"bf", "[", 
    RowBox[{"{", 
     RowBox[{"memory_", ",", "p_", ",", 
      RowBox[{"code_", "?", "BfPlus"}], ",", "cont_", ",", " ", "input_", ",",
       " ", "output_"}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"incr", "[", 
      RowBox[{"memory", ",", "p"}], "]"}], ",", "p", ",", 
     RowBox[{"drop", "[", "code", "]"}], ",", "cont", ",", "input", ",", " ", 
     "output"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bf", "[", 
    RowBox[{"{", 
     RowBox[{"memory_", ",", "p_", ",", 
      RowBox[{"code_", "?", "BfMinus"}], ",", " ", "cont_", ",", "input_", 
      ",", " ", "output_"}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"decr", "[", 
      RowBox[{"memory", ",", "p"}], "]"}], ",", "p", ",", 
     RowBox[{"drop", "[", "code", "]"}], ",", "cont", ",", " ", "input", ",", 
     " ", "output"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bf", "[", 
    RowBox[{"{", 
     RowBox[{"memory_", ",", "p_", ",", 
      RowBox[{"code_", "?", "BfLeft"}], ",", " ", "cont_", ",", "input_", ",",
       " ", "output_"}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"memory", ",", 
     RowBox[{"p", "-", "1"}], ",", 
     RowBox[{"drop", "[", "code", "]"}], ",", " ", "cont", ",", "input", ",", 
     " ", "output"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bf", "[", 
    RowBox[{"{", 
     RowBox[{"memory_", ",", "p_", ",", 
      RowBox[{"code_", "?", "BfRight"}], ",", " ", "cont_", ",", "input_", 
      ",", " ", "output_"}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"memory", ",", 
     RowBox[{"p", "+", "1"}], ",", 
     RowBox[{"drop", "[", "code", "]"}], ",", " ", "cont", ",", "input", ",", 
     " ", "output"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bf", "[", 
    RowBox[{"{", 
     RowBox[{"memory_", ",", "p_", ",", 
      RowBox[{"code_", "?", "BfPrint"}], ",", "cont_", ",", "input_", ",", 
      "output_"}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"memory", ",", "p", ",", 
     RowBox[{"drop", "[", "code", "]"}], ",", "cont", ",", "input", ",", 
     RowBox[{"putc", "[", 
      RowBox[{"output", ",", 
       RowBox[{"memory", "[", 
        RowBox[{"[", "p", "]"}], "]"}]}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bf", "[", 
    RowBox[{"{", 
     RowBox[{"memory_", ",", "p_", ",", 
      RowBox[{"code_", "?", "BfRead"}], ",", "cont_", ",", "input_", ",", 
      "output_"}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"setm", "[", 
      RowBox[{"memory", ",", "p", ",", 
       RowBox[{"getc", "[", "input", "]"}]}], "]"}], ",", 
     RowBox[{"drop", "[", "code", "]"}], ",", "cont", ",", 
     RowBox[{"drop", "[", "input", "]"}], ",", "output"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bf", "[", 
   RowBox[{"{", 
    RowBox[{
    "memory_", ",", "p_", ",", "\"\<\>\"", ",", "cont_", ",", "input_", ",", 
     "output_"}], "}"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
   "memory", ",", "p", ",", "\"\<\>\"", ",", "cont", ",", "input", ",", 
    "output"}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.582219709197947*^9, 3.582219722426214*^9}, 
   3.582219764863105*^9, {3.5822200156643753`*^9, 3.582220045195344*^9}, {
   3.582220111335176*^9, 3.582220144783691*^9}, {3.58222027201015*^9, 
   3.582220304855109*^9}, {3.5822204105231943`*^9, 3.582220458388797*^9}, {
   3.582220629072501*^9, 3.582220684903246*^9}, {3.582220732726963*^9, 
   3.582220734019642*^9}, {3.58222099668997*^9, 3.5822210033079233`*^9}, {
   3.582289337714974*^9, 3.5822893426384563`*^9}, {3.582290029599378*^9, 
   3.582290041139885*^9}, {3.582290171210969*^9, 3.582290181645005*^9}, {
   3.582290216868484*^9, 3.5822902214312468`*^9}, {3.582362791449806*^9, 
   3.582362846014241*^9}, {3.582362879540859*^9, 3.582362938044156*^9}, {
   3.582926615709453*^9, 3.582926641290244*^9}, {3.5829266868861628`*^9, 
   3.582926757610324*^9}, {3.582926788392522*^9, 3.582926808562525*^9}, {
   3.582926873948275*^9, 3.582926933163316*^9}, {3.5829269854412193`*^9, 
   3.5829269920062513`*^9}, {3.582927023831173*^9, 3.582927024509259*^9}, {
   3.582927174528393*^9, 3.582927223738611*^9}, {3.582927448872303*^9, 
   3.582927477531515*^9}, {3.5829276740691032`*^9, 3.5829276747456713`*^9}, {
   3.58292770793501*^9, 3.582927718044957*^9}, {3.5829277954191217`*^9, 
   3.582927831693707*^9}, {3.582927918273404*^9, 3.5829279709969893`*^9}, {
   3.5829289357956123`*^9, 3.582928985140562*^9}, {3.582929106599568*^9, 
   3.582929116263451*^9}, {3.58293065996817*^9, 3.5829306969253817`*^9}, {
   3.582931054672683*^9, 3.5829310556910458`*^9}, {3.594315975470722*^9, 
   3.5943160072274323`*^9}}],

Cell["Some tests of the basics.", "Text",
 CellChangeTimes->{{3.582362946775196*^9, 3.582362948366053*^9}, {
  3.582927501992292*^9, 3.582927503599146*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"bf", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "2", ",", "\"\<+q\>\"", 
    ",", 
    RowBox[{"{", "}"}], ",", "\"\<\>\"", ",", "\"\<\>\""}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.582220155538907*^9, 3.5822201730488567`*^9}, {
  3.582220654395913*^9, 3.582220655507958*^9}, {3.5829273510000257`*^9, 
  3.582927353038416*^9}, {3.582928993519618*^9, 3.582928994016173*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", "2", ",", "\<\"q\"\>", ",", 
   RowBox[{"{", "}"}], ",", "\<\"\"\>", ",", "\<\"\"\>"}], "}"}]], "Output",
 CellChangeTimes->{
  3.582220173924008*^9, {3.582220278784822*^9, 3.582220307383564*^9}, {
   3.5822206565450907`*^9, 3.582220686949129*^9}, 3.582220740227414*^9, 
   3.582221006789377*^9, 3.582289356478952*^9, 3.5822901455832243`*^9, 
   3.582290185246581*^9, 3.5822902239500227`*^9, 3.58236139229773*^9, 
   3.582362180538434*^9, 3.582362281644477*^9, 3.582362333795877*^9, 
   3.582362588544743*^9, 3.582362662118518*^9, 3.582363013389821*^9, 
   3.5824528172613688`*^9, 3.582718018797937*^9, 3.582718090865424*^9, 
   3.5829273073474703`*^9, 3.582927353982176*^9, 3.5829279839442453`*^9, 
   3.5829289958529167`*^9, {3.582929096398999*^9, 3.582929118526207*^9}, {
   3.582931045887314*^9, 3.582931078195356*^9}, 3.594315303679776*^9, 
   3.594315711780341*^9, 3.601826966911908*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"bf", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", "2", ",", "\"\<-q\>\"", 
    ",", 
    RowBox[{"{", "}"}], ",", "\"\<\>\"", ",", "\"\<\>\""}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.5823629643489513`*^9, 3.582362966703191*^9}, {
  3.582927360633999*^9, 3.582927362426181*^9}, {3.582929148912877*^9, 
  3.582929149396142*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "2", ",", "\<\"q\"\>", ",", 
   RowBox[{"{", "}"}], ",", "\<\"\"\>", ",", "\<\"\"\>"}], "}"}]], "Output",
 CellChangeTimes->{
  3.5823630163256197`*^9, 3.5824528172937393`*^9, 3.582718024673884*^9, 
   3.582718092939598*^9, 3.5829273631745358`*^9, 3.582927988296339*^9, {
   3.582929122697033*^9, 3.582929150183413*^9}, 3.594315307675808*^9, 
   3.5943157137502337`*^9, 3.601826970273744*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"bf", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "2", ",", "\"\<<q\>\"", 
    ",", 
    RowBox[{"{", "}"}], ",", "\"\<\>\"", ",", "\"\<\>\""}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.582362971794846*^9, 3.582363000587038*^9}, {
  3.5823630600152063`*^9, 3.582363076014812*^9}, {3.5829272475508127`*^9, 
  3.582927269603654*^9}, {3.582927370206262*^9, 3.5829273713655663`*^9}, {
  3.5829291545481043`*^9, 3.582929155037315*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "1", ",", "\<\"q\"\>", ",", 
   RowBox[{"{", "}"}], ",", "\<\"\"\>", ",", "\<\"\"\>"}], "}"}]], "Output",
 CellChangeTimes->{3.582927372231812*^9, 3.582927991878648*^9, 
  3.582929125174992*^9, 3.58292915537436*^9, 3.5943153098192663`*^9, 
  3.5943157147934227`*^9, 3.601826972786559*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"bf", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "2", ",", "\"\<>q\>\"", 
    ",", 
    RowBox[{"{", "}"}], ",", "\"\<\>\"", ",", "\"\<\>\""}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.582362971794846*^9, 3.582363000587038*^9}, {
  3.5823630600152063`*^9, 3.582363076014812*^9}, {3.5829272475508127`*^9, 
  3.582927269603654*^9}, {3.5829273774981127`*^9, 3.582927381017277*^9}, {
  3.5829291605213137`*^9, 3.582929161298503*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "3", ",", "\<\"q\"\>", ",", 
   RowBox[{"{", "}"}], ",", "\<\"\"\>", ",", "\<\"\"\>"}], "}"}]], "Output",
 CellChangeTimes->{{3.582363048105605*^9, 3.582363066399876*^9}, 
   3.5824528173273153`*^9, 3.5827180343653507`*^9, 3.582718095217072*^9, 
   3.582927381739134*^9, 3.5829279937372932`*^9, 3.582929127335382*^9, 
   3.5829291619031982`*^9, 3.594315311458853*^9, 3.5943157155800467`*^9, 
   3.6018269745935307`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"bf", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "65", ",", "0"}], "}"}], ",", "2", ",", "\"\<.q\>\"", 
    ",", 
    RowBox[{"{", "}"}], ",", "\"\<\>\"", ",", "\"\<\>\""}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.5829273850002613`*^9, 3.582927412689789*^9}, {
  3.5829291665818853`*^9, 3.582929167074089*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "65", ",", "0"}], "}"}], ",", "2", ",", "\<\"q\"\>", 
   ",", 
   RowBox[{"{", "}"}], ",", "\<\"\"\>", ",", "\<\"A\"\>"}], "}"}]], "Output",
 CellChangeTimes->{3.582927413579796*^9, 3.582927488288459*^9, 
  3.5829280004145517`*^9, 3.582929129609215*^9, 3.5829291677957993`*^9, 
  3.594315313049594*^9, 3.594315717304433*^9, 3.601826975848413*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"bf", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "2", ",", "\"\<,q\>\"", 
    ",", 
    RowBox[{"{", "}"}], ",", "\"\<A\>\"", ",", "\"\<\>\""}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.582927568855036*^9, 3.582927585011138*^9}, {
  3.58292917385877*^9, 3.582929174639749*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "65", ",", "0"}], "}"}], ",", "\<\"q\"\>", ",", 
   RowBox[{"{", "}"}], ",", "\<\"\"\>", ",", "\<\"\"\>"}], "}"}]], "Output",
 CellChangeTimes->{
  3.582927585716022*^9, 3.582927688917921*^9, 3.582927722447461*^9, 
   3.582928003144299*^9, 3.5829291753780737`*^9, 3.594315315141473*^9, {
   3.594315690368392*^9, 3.5943157193434362`*^9}, 3.60182697727265*^9}]
}, Open  ]],

Cell["\<\
Here\[CloseCurlyQuote]s a runner for an entire bf program: just run until the \
code string is empty (until a fixed point is reached).\
\>", "Text",
 CellChangeTimes->{{3.5829304421157084`*^9, 3.582930493691532*^9}, {
  3.582930882528035*^9, 3.5829308831813927`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"runbf", "[", 
   RowBox[{"{", 
    RowBox[{
    "memory_", ",", "p_", ",", "code_", ",", "cont_", ",", "input_", ",", 
     "output_"}], "}"}], "]"}], ":=", 
  RowBox[{"FixedPoint", "[", 
   RowBox[{"bf", ",", 
    RowBox[{"{", 
     RowBox[{
     "memory", ",", "p", ",", "code", ",", "cont", ",", "input", ",", 
      "output"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.582930463549909*^9, 3.582930465882166*^9}, {
  3.5829304985308313`*^9, 3.58293051983109*^9}, {3.582930581955936*^9, 
  3.582930609338793*^9}, {3.582930938589549*^9, 3.582930967721047*^9}, {
  3.5829310940842237`*^9, 3.582931094254578*^9}}],

Cell["Increment a cell to 10:", "Text",
 CellChangeTimes->{{3.582930619002449*^9, 3.5829306215901327`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"runbf", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "2", ",", 
    "\"\<++++++++++\>\"", ",", 
    RowBox[{"{", "}"}], ",", "\"\<\>\"", ",", "\"\<\>\""}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.582930624672477*^9, 3.582930641070629*^9}, {
  3.582930704906247*^9, 3.58293071079723*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "10", ",", "0"}], "}"}], ",", "2", ",", "\<\"\"\>", ",", 
   RowBox[{"{", "}"}], ",", "\<\"\"\>", ",", "\<\"\"\>"}], "}"}]], "Output",
 CellChangeTimes->{{3.582931090146018*^9, 3.582931096506217*^9}, {
   3.5943154408937693`*^9, 3.594315460752019*^9}, 3.594315661101961*^9, 
   3.594315733317594*^9, 3.5943157815367107`*^9, 3.594316015188674*^9, 
   3.601826984750156*^9}]
}, Open  ]],

Cell["Now we can move on to implementing loops.", "Text",
 CellChangeTimes->{{3.58292801379288*^9, 3.582928018450529*^9}}],

Cell[TextData[{
 "Here is a helper: it extracts the code following a matching ",
 StyleBox["]", "Code"],
 "."
}], "Text",
 CellChangeTimes->{{3.582928297453925*^9, 3.582928343250967*^9}, {
  3.582929238717033*^9, 3.582929250606645*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"chelp", "[", 
    RowBox[{"i_", ",", "\"\<\>\""}], "]"}], ":=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"chelp", "[", 
    RowBox[{"i_", ",", 
     RowBox[{"rest_", "?", "BfWhile"}]}], "]"}], ":=", 
   RowBox[{"chelp", "[", 
    RowBox[{
     RowBox[{"i", "+", "1"}], ",", 
     RowBox[{"drop", "[", "rest", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"chelp", "[", 
    RowBox[{
     RowBox[{"i_", "/;", 
      RowBox[{"i", ">", "0"}]}], ",", 
     RowBox[{"rest_", "?", "BfWend"}]}], "]"}], ":=", 
   RowBox[{"chelp", "[", 
    RowBox[{
     RowBox[{"i", "-", "1"}], ",", 
     RowBox[{"drop", "[", "rest", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"chelp", "[", 
    RowBox[{
     RowBox[{"i_", "/;", 
      RowBox[{"i", "==", "0"}]}], ",", 
     RowBox[{"rest_", "?", "BfWend"}]}], "]"}], ":=", 
   RowBox[{"drop", "[", "rest", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"chelp", "[", 
   RowBox[{"i_", ",", "rest_"}], "]"}], ":=", 
  RowBox[{"chelp", "[", 
   RowBox[{"i", ",", 
    RowBox[{"drop", "[", "rest", "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.582929284771351*^9, 3.58292930127559*^9}, {
   3.5829294589468822`*^9, 3.5829296185323133`*^9}, 3.582929715951713*^9}],

Cell["\<\
Next, loop logic. This is done as in the earlier Haskell implementation: \
extract the continuation (i.e., the code after the loop) and put it on the \
stack.\
\>", "Text",
 CellChangeTimes->{{3.582928353847843*^9, 3.582928408297647*^9}, {
  3.5829297814072657`*^9, 3.5829297998358717`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bf", "[", 
   RowBox[{"{", 
    RowBox[{"memory_", ",", "p_", ",", 
     RowBox[{"code_", "?", "BfWhile"}], ",", "cont_", ",", "input_", ",", 
     "output_"}], "}"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"memory", "[", 
      RowBox[{"[", "p", "]"}], "]"}], "\[Equal]", "0"}], ",", 
    RowBox[{"{", 
     RowBox[{"memory", ",", "p", ",", 
      RowBox[{"chelp", "[", 
       RowBox[{"0", ",", 
        RowBox[{"drop", "[", "code", "]"}]}], "]"}], ",", "cont", ",", 
      "input", ",", "output"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"memory", ",", "p", ",", 
      RowBox[{"drop", "[", "code", "]"}], ",", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "code", "}"}], ",", "cont"}], "]"}], ",", "input", ",", 
      "output"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bf", "[", 
   RowBox[{"{", 
    RowBox[{"memory_", ",", "p_", ",", 
     RowBox[{"code_", "?", "BfWend"}], ",", "cont_", ",", "input_", ",", 
     "output_"}], "}"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"memory", ",", "p", ",", 
    RowBox[{"cont", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", 
    RowBox[{"Drop", "[", 
     RowBox[{"cont", ",", "1"}], "]"}], ",", "input", ",", "output"}], 
   "}"}]}]}], "Input",
 CellChangeTimes->{{3.5829280705024767`*^9, 3.58292809750526*^9}, {
  3.582928413385242*^9, 3.58292845280274*^9}, {3.582929205365901*^9, 
  3.582929219640121*^9}, {3.5829298490547123`*^9, 3.5829298600685043`*^9}, {
  3.5829298904668407`*^9, 3.582929951378347*^9}, {3.582930013677471*^9, 
  3.582930042016396*^9}, {3.582930114704295*^9, 3.582930135649835*^9}, {
  3.5829302572217197`*^9, 3.582930262656794*^9}}],

Cell["A test for loop logic.", "Text",
 CellChangeTimes->{{3.5829302724056063`*^9, 3.5829302811098557`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"runbf", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "1", ",", 
    "\"\<+++[>+<-]\>\"", ",", 
    RowBox[{"{", "}"}], ",", "\"\<\>\"", ",", "\"\<\>\""}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.5829302846815453`*^9, 3.5829303354095087`*^9}, {
  3.582930394029085*^9, 3.582930410355323*^9}, {3.582931135110552*^9, 
  3.582931148497551*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "3", ",", "0"}], "}"}], ",", "1", ",", "\<\"\"\>", ",", 
   
   RowBox[{"{", "}"}], ",", "\<\"\"\>", ",", "\<\"\"\>"}], "}"}]], "Output",
 CellChangeTimes->{
  3.582930416935261*^9, {3.582931138105468*^9, 3.5829311500756397`*^9}, 
   3.5943160297344227`*^9, 3.6018270044385643`*^9}]
}, Open  ]],

Cell["We might as well try this now.", "Text",
 CellChangeTimes->{{3.582931171460463*^9, 3.582931175310956*^9}}],

Cell[BoxData[
 RowBox[{"helloWorld", ":=", 
  "\"\<++++++++[>++++[>++>+++>+++>+<<<<-]>+>->+>>+[<]<-]>>.>>---.+++++++..+++.\
>.<<-.>.+++.------.--------.>+.\>\""}]], "Input",
 CellChangeTimes->{{3.582931185108904*^9, 3.582931217817244*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"runbf", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"PadRight", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "30"}], "]"}], ",", "1", ",", "helloWorld", 
    ",", 
    RowBox[{"{", "}"}], ",", "\"\<\>\"", ",", "\"\<\>\""}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.5829314495008*^9, 3.582931489824477*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "72", ",", "87", ",", "100", ",", "33", ",", "8", ",",
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0", ",", "0"}], "}"}], ",", "6", ",", "\<\"\"\>", ",", 
   RowBox[{"{", "}"}], ",", "\<\"\"\>", ",", "\<\"Hello World!\"\>"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.5829314907164*^9, 3.594316065134828*^9, 
  3.601827018987857*^9}]
}, Open  ]]
},
WindowSize->{1197, 928},
WindowMargins->{{Automatic, 175}, {Automatic, 20}},
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, \
2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 333, 9, 125, "Text"],
Cell[893, 31, 92, 1, 30, "Text"],
Cell[988, 34, 1912, 54, 114, "Input"],
Cell[2903, 90, 354, 7, 30, "Text"],
Cell[3260, 99, 714, 13, 28, "Input"],
Cell[3977, 114, 99, 1, 30, "Text"],
Cell[4079, 117, 1436, 37, 148, "Input"],
Cell[5518, 156, 645, 10, 144, "Text"],
Cell[6166, 168, 157, 3, 30, "Text"],
Cell[6326, 173, 4843, 112, 131, "Input"],
Cell[11172, 287, 156, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[11353, 293, 468, 11, 28, "Input"],
Cell[11824, 306, 1001, 17, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12862, 328, 420, 11, 28, "Input"],
Cell[13285, 341, 500, 10, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13822, 356, 521, 12, 28, "Input"],
Cell[14346, 370, 396, 8, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14779, 383, 521, 12, 28, "Input"],
Cell[15303, 397, 527, 10, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15867, 412, 374, 10, 28, "Input"],
Cell[16244, 424, 425, 9, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16706, 438, 369, 10, 28, "Input"],
Cell[17078, 450, 438, 9, 28, "Output"]
}, Open  ]],
Cell[17531, 462, 277, 5, 30, "Text"],
Cell[17811, 469, 656, 16, 28, "Input"],
Cell[18470, 487, 107, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[18602, 492, 379, 10, 28, "Input"],
Cell[18984, 504, 451, 9, 28, "Output"]
}, Open  ]],
Cell[19450, 516, 122, 1, 30, "Text"],
Cell[19575, 519, 236, 6, 30, "Text"],
Cell[19814, 527, 1373, 43, 97, "Input"],
Cell[21190, 572, 301, 6, 30, "Text"],
Cell[21494, 580, 1728, 43, 63, "Input"],
Cell[23225, 625, 108, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[23358, 630, 432, 11, 28, "Input"],
Cell[23793, 643, 361, 9, 28, "Output"]
}, Open  ]],
Cell[24169, 655, 112, 1, 30, "Text"],
Cell[24284, 658, 239, 4, 28, "Input"],
Cell[CellGroupData[{
Cell[24548, 666, 346, 10, 28, "Input"],
Cell[24897, 678, 618, 13, 86, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
